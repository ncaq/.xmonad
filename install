#!/bin/zsh
set -eux

stack install . xmobar --flag xmobar:with_xft --flag xmobar:with_datezone
cp script/* ~/.local/bin/

systemd_dir=${0:a:h}/systemd/
hostname=$(hostname)

cd ~/.config/systemd/user/
for f in $(ls $systemd_dir)
do
  # xkbsetはindigo向けのパッチなのでそこだけに貼ります。
  if [[ $f == xkbset* ]]; then
    if [[ $hostname == indigo ]]; then
      ln -s $(realpath --relative-to=. $systemd_dir/$f) .
    fi
  else
    ln -f -s $(realpath --relative-to=. $systemd_dir/$f) .
  fi
done
